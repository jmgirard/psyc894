{
  "hash": "a23a5853cf98ec0bf7a2296cb170f286",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat: \n  revealjs:\n    css: ../../styles.css\n    slide-number: true\n    show-slide-number: all\n    preview-links: false\n    progress: true\n    history: true\n    hash-type: number\n    theme: default\n    code-block-background: true\n    highlight-style: zenburn\n    code-link: false\n    code-copy: true\n    code-line-numbers: false\n    controls: true\n    pagetitle: \"Multilevel Modeling\"\n    author-meta: \"Jeffrey Girard\"\n    semester: \"Spring 2026\"\n    course: \"PSYC 894\"\n    lecture: \"02a\"\nexecute:\n  echo: true\n  eval: true\n  collapse: false\n  cache: false\n---\n\n::: {.my-title}\n# [Multilevel Modeling]{.blue}\nLinear Modeling Recap\n\n::: {.my-grey}\n[{{< meta semester >}} | CLAS | {{< meta course >}}]{}<br />\n[Jeffrey M. Girard | Lecture {{< meta lecture >}}]{}\n:::\n\n![](../../img/city-girl.svg){.absolute bottom=30 right=0 width=\"400\"}\n:::\n\n## Roadmap\n\n::: {.columns .pv4}\n\n::: {.column width=\"60%\"}\n1. Simple Regression\n  \n2. Multiple Regression\n\n3. Categorical Predictors\n:::\n\n::: {.column .tc .pv4 width=\"40%\"}\n{{< lif \"../../icons/map.json\" trigger=hover colors=secondary:#2a76dd class=rc >}}\n:::\n\n:::\n\n# R Setup\n\n## Load Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(c(\"easystats\", \"marginaleffects\", \"ggplot2\"))\nlibrary(easystats)\nlibrary(marginaleffects)\nlibrary(ggplot2)\n```\n:::\n\n\n## Example Dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_codebook(penguins)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\npenguins (344 rows and 8 variables, 8 shown)\n\nID | Name        | Type        |  Missings |       Values |           N\n---+-------------+-------------+-----------+--------------+------------\n1  | species     | categorical |  0 (0.0%) |       Adelie | 152 (44.2%)\n   |             |             |           |    Chinstrap |  68 (19.8%)\n   |             |             |           |       Gentoo | 124 (36.0%)\n---+-------------+-------------+-----------+--------------+------------\n2  | island      | categorical |  0 (0.0%) |       Biscoe | 168 (48.8%)\n   |             |             |           |        Dream | 124 (36.0%)\n   |             |             |           |    Torgersen |  52 (15.1%)\n---+-------------+-------------+-----------+--------------+------------\n3  | bill_len    | numeric     |  2 (0.6%) | [32.1, 59.6] |         342\n---+-------------+-------------+-----------+--------------+------------\n4  | bill_dep    | numeric     |  2 (0.6%) | [13.1, 21.5] |         342\n---+-------------+-------------+-----------+--------------+------------\n5  | flipper_len | integer     |  2 (0.6%) |   [172, 231] |         342\n---+-------------+-------------+-----------+--------------+------------\n6  | body_mass   | integer     |  2 (0.6%) | [2700, 6300] |         342\n---+-------------+-------------+-----------+--------------+------------\n7  | sex         | categorical | 11 (3.2%) |       female | 165 (49.5%)\n   |             |             |           |         male | 168 (50.5%)\n---+-------------+-------------+-----------+--------------+------------\n8  | year        | integer     |  0 (0.0%) |         2007 | 110 (32.0%)\n   |             |             |           |         2008 | 114 (33.1%)\n   |             |             |           |         2009 | 120 (34.9%)\n-----------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n::: {.fsmaller}\n*Note that this dataset is already included with recent versions of R.*\n:::\n\n# Simple Regression\n\n## Simple Regression {.smaller}\n\n::: {.columns .pv4}\n::: {.column width=\"60%\"}\n-   [Simple regression]{.b .blue} predicts one variable $y$ from another variable $x$ using a straight line\n\n::: {.fragment .mt1}\n-   This line is defined by two parameters\n    -   The [intercept]{.b .green} is the value of $y$ when $x=0$\n    -   The [slope]{.b .green} is the change in $y$ expected for a change of 1 in $x$ (from $x=0$ to $x=1$)\n:::\n\n::: {.fragment .mt1}\n-   We will use `lm()` to fit regression models\n    -   This will solve using ordinary least squares\n    -   We need to give it the [data]{.b .green} and a [formula]{.b .green}\n:::\n:::\n\n::: {.column .tc .pv5 width=\"40%\"}\n{{< lif \"../../icons/scatter.json\" trigger=hover colors=secondary:#2a76dd class=rc >}}\n:::\n:::\n\n## SR Equation Notation\n\n#### Generic\n\n$$y_i = \\beta_0 + \\beta_1 x_{i} + \\varepsilon_{i}$$\n\n:::{.tc}\nwhere $y_i$ is the continuous response value for observation $i$,<br>\n$x_i$ is the continuous predictor value for observation $i$,<br>\n$\\beta_0$ and $\\beta_1$ are the estimated intercept and slope, and<br>\n$\\varepsilon_i$ is the estimated residual (error) for observation $i$\n:::\n\n#### Example\n\n$$\\text{MASS}_i = \\beta_0 + \\beta_1 \\text{FLEN}_{i} + \\varepsilon_i$$\n\n## SR Formula Notation\n\n#### Generic\n:::{.tc}\n`y ~ 1 + x`\n\nwhere *y* is the response variable name,<br>\n*1* tells R to estimate the intercept,<br>\nand *x* is the continuous predictor variable name\n:::\n\n#### Example\n:::{.tc}\n`body_mass ~ 1 + flipper_len`\n:::\n\n## SR Path Diagram {.nostretch}\n\n![](../../diagrams/simple_regression_full.png){width=\"75%\"}\n\n## SR Estimation\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsr_f <- lm(\n  formula = body_mass ~ 1 + flipper_len,\n  data = penguins\n)\n```\n:::\n\n\n:::{.pv4 .fragment}\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_parameters(sr_f)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter   | Coefficient |     SE |               95% CI | t(340) |      p\n---------------------------------------------------------------------------\n(Intercept) |    -5780.83 | 305.81 | [-6382.36, -5179.30] | -18.90 | < .001\nflipper len |       49.69 |   1.52 | [   46.70,    52.67] |  32.72 | < .001\n```\n\n\n:::\n:::\n\n:::{.fsmaller}\nIntercept: Predict a penguin with 0mm flipper length has --5781g body mass.<br />\nSlope: Predict increase of 1mm flipper length increases body mass by 49.7g.<br />\n*Conclude: Flipper length is significantly (and positively) related to body mass.*\n:::\n:::\n\n## SR Centering\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_c <- center(penguins, select = \"flipper_len\")\nsr_f_c <- lm(formula = body_mass ~ 1 + flipper_len, data = penguins_c)\n```\n:::\n\n\n:::{.pv4 .fragment}\n\n::: {.cell}\n\n```{.r .cell-code}\ncompare_parameters(sr_f, sr_f_c, select = \"{estimate}{stars}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter    |        sr_f |     sr_f_c\n---------------------------------------\n(Intercept)  | -5780.83*** | 4201.75***\nflipper len  |    49.69*** |   49.69***\n---------------------------------------\nObservations |         342 |        342\n```\n\n\n:::\n:::\n\n:::{.fsmaller}\nThe slope doesn't change, but the intercept does and is now the predicted body mass for a penguin with *average* flipper length (rather than 0mm).\n:::\n:::\n\n## SR Standardizing\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_z <- standardize(penguins, select = c(\"body_mass\", \"flipper_len\"))\nsr_f_z <- lm(formula = body_mass ~ 1 + flipper_len, data = penguins_z)\n```\n:::\n\n\n:::{.pv4 .fragment}\n\n::: {.cell}\n\n```{.r .cell-code}\ncompare_parameters(sr_f, sr_f_z, select = \"{estimate}{stars}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter    |        sr_f |      sr_f_z\n----------------------------------------\n(Intercept)  | -5780.83*** |    1.02e-15\nflipper len  |    49.69*** |     0.87***\n----------------------------------------\nObservations |         342 |         342\n```\n\n\n:::\n:::\n\n:::{.fsmaller}\nThe intercept is now zero and the slope is now the change in body mass in SD units (rather than grams) associated with a change of 1 SD in flipper length.\n:::\n:::\n\n## SR Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\npred_srf <- estimate_relation(sr_f, by = \"flipper_len\")\nplot(pred_srf)\n```\n\n::: {.cell-output-display}\n![](a_Slides_files/figure-revealjs/unnamed-chunk-9-1.png){width=960}\n:::\n:::\n\n\n## Visualization Customization\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(pred_srf, show_data = TRUE, dot_size = 5, line_size = 1.5) +\n  scale_y_continuous(limits = c(2500, 6500)) +\n  labs(x = \"Flipper length (mm)\", y = \"Body mass (g)\") +\n  theme_bw(base_size = 30)\n```\n\n::: {.cell-output-display}\n![](a_Slides_files/figure-revealjs/unnamed-chunk-10-1.png){width=960}\n:::\n:::\n\n\n# Multiple Regression\n\n## Multiple Regression {.smaller}\n\n::: {.columns .pv4}\n::: {.column width=\"60%\"}\n-   We can also include [multiple predictors]{.b .blue} to assess the [partial effect]{.b .green} of each predictor\n    -   This allows us to account for the variance shared by the predictors and the outcome\n\n::: {.fragment .mt1}\n-   This changes the slopes' interpretations\n    -   The slope of $x_1$ is no longer just the change in $y$ expected for a change of 1 in $x_1$\n    -   It is now the change in $y$ expected for a change of 1 in $x_1$ **when controlling for $x_2$**\n    -   The slope of $x_2$ similarly controls for $x_1$\n:::\n:::\n\n::: {.column .tc .pv5 width=\"40%\"}\n{{< lif \"../../icons/venn.json\" trigger=hover colors=secondary:#2a76dd class=rc >}}\n:::\n:::\n\n## MR Equation Notation\n\n#### Generic\n$$y_i = \\beta_0 + \\sum_{p=1}^P \\beta_p x_{pi} + \\varepsilon_{i}$$\n\n:::{.tc}\nwhere $P$ is the number of predictors\n:::\n\n#### Example\n$$\\text{MASS}_i = \\beta_0 + \\beta_1 \\text{FLEN}_{i} + \\beta_2 \\text{BDEP}_{i} + \\varepsilon_i$$\n\n## MR Formula Notation\n\n#### Generic\n:::{.tc}\n`y ~ 1 + x1 + ... + xP`\n\nwhere $\\text{x1},\\ldots,\\text{xP}$ are the predictor variable names\n:::\n\n#### Example\n:::{.tc}\n`body_mass ~ 1 + flipper_len + bill_dep`\n:::\n\n## MR Path Diagram {.nostretch}\n![](../../diagrams/multiple_regression_full.png){width=\"70%\"}\n\n## MR Estimation\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmr_fb <- lm(\n  formula = body_mass ~ 1 + flipper_len + bill_dep,\n  data = penguins\n)\n```\n:::\n\n\n:::{.pv4 .fragment}\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_parameters(mr_fb)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter   | Coefficient |     SE |               95% CI | t(339) |      p\n---------------------------------------------------------------------------\n(Intercept) |    -6541.91 | 540.75 | [-7605.56, -5478.26] | -12.10 | < .001\nflipper len |       51.54 |   1.87 | [   47.87,    55.21] |  27.64 | < .001\nbill dep    |       22.63 |  13.28 | [   -3.49,    48.76] |   1.70 | 0.089 \n```\n\n\n:::\n:::\n\n\n::: {.fsmaller}\nThe intercept is body mass when all predictors equal 0. Flipper length was significantly related to body mass while controlling for bill depth. Bill depth was not significantly related to body mass while controlling for flipper length.\n:::\n:::\n\n## SR vs. MR Estimates\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsr_b <- lm(body_mass ~ 1 + bill_dep, data = penguins)\n```\n:::\n\n\n:::{.pv4 .fragment}\n\n::: {.cell}\n\n```{.r .cell-code}\ncompare_parameters(sr_f, sr_b, mr_fb, select = \"{estimate}{stars}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter    |        sr_f |       sr_b |       mr_fb\n-----------------------------------------------------\n(Intercept)  | -5780.83*** | 7488.65*** | -6541.91***\nflipper len  |    49.69*** |            |    51.54***\nbill dep     |             | -191.64*** |       22.63\n-----------------------------------------------------\nObservations |         342 |        342 |         342\n```\n\n\n:::\n:::\n\n\n:::\n\n:::{.f1 .fragment}\n- The slopes from SR are called \"zero-order\" (total) effects.\n- The slopes from MR are called \"partial\" (unique) effects.\n:::\n\n## SR vs. MR Visualization (FLEN)\n\n:::{.columns}\n\n:::{.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npred_srf <- estimate_relation(\n  sr_f, by = \"flipper_len\"\n)\nplot(pred_srf) + theme_bw(30)\n```\n\n::: {.cell-output-display}\n![](a_Slides_files/figure-revealjs/unnamed-chunk-15-1.png){width=960}\n:::\n:::\n\n:::\n\n:::{.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npred_mrf <- estimate_relation(\n  mr_fb, by = \"flipper_len\"\n)\nplot(pred_mrf) + theme_bw(30)\n```\n\n::: {.cell-output-display}\n![](a_Slides_files/figure-revealjs/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n\n:::\n:::\n\n## SR vs. MR Visualization (BDEP)\n\n:::{.columns}\n\n:::{.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npred_srb <- estimate_relation(\n  sr_b, by = \"bill_dep\"\n)\nplot(pred_srb) + theme_bw(30)\n```\n\n::: {.cell-output-display}\n![](a_Slides_files/figure-revealjs/unnamed-chunk-17-1.png){width=960}\n:::\n:::\n\n:::\n\n:::{.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npred_mrb <- estimate_relation(\n  mr_fb, by = \"bill_dep\"\n)\nplot(pred_mrb) + theme_bw(30)\n```\n\n::: {.cell-output-display}\n![](a_Slides_files/figure-revealjs/unnamed-chunk-18-1.png){width=960}\n:::\n:::\n\n\n:::\n:::\n\n# Categorical Predictors\n\n## Categorical Predictors {.smaller}\n\n::: {.columns .pv4}\n::: {.column width=\"60%\"}\n-   To include categorical predictors in regression models, we can use [dummy coding]{.b .blue}\n    -   This creates binary predictor variables\n\n::: {.fragment .mt1}\n-   One [reference group]{.b .green} does not get a slope\n    -   Instead, it controls the model intercept\n    -   All other groups' slopes are just deviations from the intercept\n:::\n\n::: {.fragment .mt1}\n-   There is no need to create dummy codes in R\n    -   Just include a [factor]{.b .green} as a predictor variable\n    -   The **first level** will be the reference group\n:::\n:::\n\n::: {.column .tc .pv5 width=\"40%\"}\n{{< lif \"../../icons/theater.json\" trigger=hover colors=secondary:#2a76dd class=rc >}}\n:::\n:::\n\n# Categorical SR\n\n## CSR Equation Notation {.smaller}\n\n#### Generic\n$$y_i = \\beta_0 + \\sum_{c=1}^{C-1} \\beta_c d_{ci} + \\varepsilon_{i}$$\n\n:::{.tc}\nwhere $C$ is the number of levels in the categorical predictor and<br>\n$d_{ci}$ represents whether observation $i$ has level $c$ ($0$: no, $1$: yes)\n:::\n\n#### Example 1\n$$\\text{MASS}_i = \\beta_0 + \\beta_1 \\text{MALE}_{i} + \\varepsilon_i$$\n\n#### Example 2\n$$\\text{MASS}_i = \\beta_0 + \\beta_1 \\text{CHIN}_i + \\beta_2 \\text{GENT}_i + \\varepsilon_i$$\n\n## CSR Formula Notation\n\n#### Generic\n:::{.tc}\n`y ~ 1 + f`\n\nwhere *f* is an unordered factor and<br>\nthe first level is the reference group\n:::\n\n#### Example 1\n:::{.tc}\n`body_mass ~ 1 + sex`\n:::\n\n#### Example 2\n:::{.tc}\n`body_mass ~ 1 + species`\n:::\n\n## CSR Path Diagram (2 Levels) {.nostretch}\n\n![](../../diagrams/categorical_regression_full2.png){width=\"70%\"}\n\n## CSR Path Diagram (3 Levels) {.nostretch}\n\n![](../../diagrams/categorical_regression_full3.png){width=\"70%\"}\n\n## Data Prep\n\nThe `sex` and `species` variables are already factors!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxtabs(formula = ~ sex + species, data = penguins)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        species\nsex      Adelie Chinstrap Gentoo\n  female     73        34     58\n  male       73        34     61\n```\n\n\n:::\n:::\n\n\n\nBut if they weren't, we would need to convert them:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins$sex <- factor(penguins$sex)\npenguins$species <- factor(penguins$species)\n```\n:::\n\n\n## CSR Estimation (2 levels)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncsr_sx <- lm(\n  formula = body_mass ~ 1 + sex,\n  data = penguins\n)\n```\n:::\n\n\n:::{.pv4 .fragment}\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_parameters(csr_sx)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter   | Coefficient |    SE |             95% CI | t(331) |      p\n------------------------------------------------------------------------\n(Intercept) |     3862.27 | 56.83 | [3750.48, 3974.06] |  67.96 | < .001\nsex [male]  |      683.41 | 80.01 | [ 526.02,  840.80] |   8.54 | < .001\n```\n\n\n:::\n:::\n\n\n:::{.fsmaller}\nIntercept: The predicted body mass of the reference group (female).<br />\nSlope: The difference between the named (male) and reference groups.<br />\n*On average, males had significantly higher body mass than females.*\n:::\n:::\n\n## CSR Means (2 levels)\n\n\n::: {.cell}\n\n```{.r .cell-code}\npred_sx <- estimate_means(csr_sx, by = \"sex\", estimate = \"average\")\npred_sx\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAverage Predictions\n\nsex    |    Mean |    SE |             95% CI | t(331)\n------------------------------------------------------\nfemale | 3862.27 | 56.83 | [3750.48, 3974.06] |  67.96\nmale   | 4545.68 | 56.32 | [4434.90, 4656.47] |  80.71\n\nVariable predicted: body_mass\nPredictors modulated: sex\n```\n\n\n:::\n:::\n\n\n:::{.fsmaller}\nThe average body mass was approx. 3862 for females and 4546 for males.\n:::\n\n## CSR Visualization (2 levels)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(pred_sx, dot_size = 5, line_size = 1.5) + \n  scale_y_continuous(limits = c(3500, 5000)) +\n  labs(x = \"Sex\", y = \"Body Mass (g)\") +\n  theme_bw(base_size = 30)\n```\n\n::: {.cell-output-display}\n![](a_Slides_files/figure-revealjs/unnamed-chunk-24-1.png){width=960}\n:::\n:::\n\n\n## CSR Estimation (3 levels)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncsr_sp <- lm(\n  formula = body_mass ~ 1 + species,\n  data = penguins\n)\n```\n:::\n\n\n:::{.pv4 .fragment}\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_parameters(csr_sp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter           | Coefficient |    SE |             95% CI | t(339) |      p\n--------------------------------------------------------------------------------\n(Intercept)         |     3700.66 | 37.62 | [3626.67, 3774.66] |  98.37 | < .001\nspecies [Chinstrap] |       32.43 | 67.51 | [-100.37,  165.22] |   0.48 | 0.631 \nspecies [Gentoo]    |     1375.35 | 56.15 | [1264.91, 1485.80] |  24.50 | < .001\n```\n\n\n:::\n:::\n\n\n:::{.fsmaller}\nIntercept: Estimated body mass for reference group (Adelie)<br />\nSlopes: Difference between named group and reference group<br />\n*Note: This table *does not* compare the Chinstrap and Gentoo groups!*\n:::\n:::\n\n## CSR Means (3 levels)\n\n::: {.cell}\n\n```{.r .cell-code}\npred_sp <- estimate_means(csr_sp, by = \"species\")\npred_sp\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEstimated Marginal Means\n\nspecies   |    Mean |    SE |             95% CI | t(339)\n---------------------------------------------------------\nAdelie    | 3700.66 | 37.62 | [3626.67, 3774.66] |  98.37\nChinstrap | 3733.09 | 56.06 | [3622.82, 3843.36] |  66.59\nGentoo    | 5076.02 | 41.68 | [4994.03, 5158.00] | 121.78\n\nVariable predicted: body_mass\nPredictors modulated: species\n```\n\n\n:::\n:::\n\n\n\n## CSR Visualization (3 levels)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(pred_sp, dot_size = 5, line_size = 1.5) +\n  labs(x = \"Species\", y = \"Body Mass (g)\") +\n  theme_bw(base_size = 30)\n```\n\n::: {.cell-output-display}\n![](a_Slides_files/figure-revealjs/unnamed-chunk-28-1.png){width=960}\n:::\n:::\n\n\n## CSR Pairwise Contrasts\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestimate_contrasts(\n  model = csr_sp, \n  contrast = \"species\", \n  comparison = \"pairwise\", # compare pairs of groups\n  estimate = \"average\",\n  p_adjust = \"holm\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAveraged Contrasts Analysis\n\nLevel1    | Level2    | Difference |    SE |             95% CI | t(339) |      p\n---------------------------------------------------------------------------------\nChinstrap | Adelie    |      32.43 | 67.51 | [-100.37,  165.22] |   0.48 |  0.631\nGentoo    | Adelie    |    1375.35 | 56.15 | [1264.91, 1485.80] |  24.50 | < .001\nGentoo    | Chinstrap |    1342.93 | 69.86 | [1205.52, 1480.34] |  19.22 | < .001\n\nVariable predicted: body_mass\nPredictors contrasted: species\np-value adjustment method: Holm (1979)\n```\n\n\n:::\n:::\n\n\n## CSR Deviation Contrasts\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestimate_contrasts(\n  model = csr_sp, \n  contrast = \"species\",\n  comparison = \"meandev\", # compare groups to mean of all\n  estimate = \"average\",\n  p_adjust = \"holm\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAveraged Contrasts Analysis\n\nLevel1    | Level2 | Difference |    SE |             95% CI | t(339) |      p\n------------------------------------------------------------------------------\nAdelie    | Mean   |    -469.26 | 34.22 | [-536.58, -401.94] | -13.71 | < .001\nChinstrap | Mean   |    -436.83 | 41.80 | [-519.05, -354.62] | -10.45 | < .001\nGentoo    | Mean   |     906.09 | 35.76 | [ 835.76,  976.43] |  25.34 | < .001\n\nVariable predicted: body_mass\nPredictors contrasted: species\np-value adjustment method: Holm (1979)\n```\n\n\n:::\n:::\n\n\n# Categorical MR\n\n## CMR Equation Notation {.smaller}\n\n#### Generic\n$$y_i = \\beta_0 + \\sum_{p=1}^P \\beta_p x_{pi} + \n\\sum_{k=1}^K \\sum_{c=1}^{C_k-1} \\beta_{kc} d_{kci}+ \n\\varepsilon_{i}$$\n\n:::{.tc}\nwhere $P$ is the number of continuous predictors,<br>\n$K$ is the number of categorical predictors (each with $C_k$ levels),<br>\nand $d_{kci}$ is a dummy code for obs. $i$ in level $c$ of predictor $k$\n:::\n\n#### Example\n$$\\text{MASS}_i = \\beta_0 + \\beta_1 \\text{FLEN}_i + \\beta_2 \\text{MALE}_{i} + \\\\\n\\beta_3 \\text{CHIN}_i + \\beta_4 \\text{GENT}_i + \\varepsilon_i$$\n\n## CMR Formula Notation\n\n#### Generic\n:::{.tc}\n`y ~ 1 + (x1 + ... + xP) + (f1 + ... + fK)`\n\nwhere $\\text{x1},\\ldots,\\text{xP}$ are continuous predictors,<br>\n$\\text{f1},\\ldots,\\text{fK}$ are unordered factor predictors, and<br>\nthe parentheses are optional (for clarity only)\n:::\n\n#### Example\n:::{.tc}\n`body_mass ~ 1 + flipper_len + sex + species`\n:::\n\n\n## CMR Path Diagram\n\n![](../../diagrams/complex_regression_full.png)\n\n## CMR Estimation\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncmr <- lm(\n  formula = body_mass ~ 1 + flipper_len + sex + species,\n  data = penguins\n)\n```\n:::\n\n\n:::{.pv4 .fragment}\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_parameters(cmr)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter           | Coefficient |     SE |              95% CI | t(328) |      p\n----------------------------------------------------------------------------------\n(Intercept)         |     -365.82 | 532.05 | [-1412.48,  680.84] |  -0.69 | 0.492 \nflipper len         |       20.02 |   2.85 | [   14.43,   25.62] |   7.04 | < .001\nsex [male]          |      530.38 |  37.81 | [  456.00,  604.76] |  14.03 | < .001\nspecies [Chinstrap] |      -87.63 |  46.35 | [ -178.81,    3.54] |  -1.89 | 0.060 \nspecies [Gentoo]    |      836.26 |  85.19 | [  668.68, 1003.84] |   9.82 | < .001\n```\n\n\n:::\n:::\n\n\n:::\n\n## CMR Visualization: Continuous\n\n\n::: {.cell}\n\n```{.r .cell-code}\npred_cmrf <- estimate_relation(cmr, by = \"flipper_len\", estimate = \"average\")\nplot(pred_cmrf, dot_size = 5, line_size = 1.5) +\n  labs(x = \"Flipper Length (mm)\", y = \"Body Mass (g)\", \n       subtitle = \"Controlling for Sex and Species\") + \n  theme_bw(base_size = 30)\n```\n\n::: {.cell-output-display}\n![](a_Slides_files/figure-revealjs/unnamed-chunk-33-1.png){width=960}\n:::\n:::\n\n\n## CMR Means\n\n\n::: {.cell}\n\n```{.r .cell-code}\npred_cmrs <- estimate_means(cmr, by = \"species\", estimate = \"average\")\npred_cmrs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAverage Predictions\n\nspecies   |    Mean |    SE |             95% CI | t(328)\n---------------------------------------------------------\nAdelie    | 3706.16 | 24.46 | [3658.04, 3754.28] | 151.51\nChinstrap | 3733.09 | 35.84 | [3662.58, 3803.60] | 104.15\nGentoo    | 5092.44 | 27.09 | [5039.14, 5145.74] | 187.95\n\nVariable predicted: body_mass\nPredictors modulated: species\n```\n\n\n:::\n:::\n\n\n## CMR Visualization: Categorical\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(pred_cmrs, dot_size = 5, line_size = 1.5) +\n  labs(x = \"Species\", y = \"Body Mass (g)\", \n       subtitle = \"Controlling for Sex and Flipper Length\") + \n  theme_bw(base_size = 30)\n```\n\n::: {.cell-output-display}\n![](a_Slides_files/figure-revealjs/unnamed-chunk-35-1.png){width=960}\n:::\n:::\n\n\n## CMR Pairwise Contrasts\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestimate_contrasts(\n  model = cmr,\n  contrast = \"species\",\n  comparison = \"pairwise\", # compare pairs of groups\n  estimate = \"average\",\n  p_adjust = \"holm\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAveraged Contrasts Analysis\n\nLevel1    | Level2    | Difference |    SE |             95% CI | t(328) |      p\n---------------------------------------------------------------------------------\nChinstrap | Adelie    |      26.92 | 43.39 | [ -58.44,  112.29] |   0.62 |  0.535\nGentoo    | Adelie    |    1386.27 | 36.50 | [1314.46, 1458.08] |  37.98 | < .001\nGentoo    | Chinstrap |    1359.35 | 44.93 | [1270.96, 1447.74] |  30.25 | < .001\n\nVariable predicted: body_mass\nPredictors contrasted: species\np-value adjustment method: Holm (1979)\n```\n\n\n:::\n:::\n\n\n## CMR Deviation Contrasts\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestimate_contrasts(\n  model = cmr,\n  contrast = \"species\",\n  comparison = \"meandev\", # compare groups to mean of all\n  estimate = \"average\",\n  p_adjust = \"holm\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAveraged Contrasts Analysis\n\nLevel1    | Level2 | Difference |    SE |             95% CI | t(328) |      p\n------------------------------------------------------------------------------\nAdelie    | Mean   |    -471.07 | 22.14 | [-514.62, -427.51] | -21.28 | < .001\nChinstrap | Mean   |    -444.14 | 26.81 | [-496.89, -391.39] | -16.56 | < .001\nGentoo    | Mean   |     915.21 | 23.14 | [ 869.68,  960.73] |  39.55 | < .001\n\nVariable predicted: body_mass\nPredictors contrasted: species\np-value adjustment method: Holm (1979)\n```\n\n\n:::\n:::\n\n\n",
    "supporting": [
      "a_Slides_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}